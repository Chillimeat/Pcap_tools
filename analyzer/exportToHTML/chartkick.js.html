<html>
<head>
<title>chartkick.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: rgb(0,0,0); font-weight: normal; font-style: normal; }
.s0 { color: rgb(128,128,128); font-style: italic; }
.s1 { color: rgb(0,0,0); }
.s2 { color: rgb(0,0,128); font-weight: bold; }
.s3 { color: rgb(0,128,0); font-weight: bold; }
.s4 { color: rgb(0,0,255); }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
chartkick.js</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">/* 
 * Chartkick.js 
 * Create beautiful Javascript charts with minimal code 
 * https://github.com/ankane/chartkick.js 
 * v1.1.0 
 * MIT License 
 */</span><span class="s1"> 
 
</span><span class="s0">/*jslint browser: true, indent: 2, plusplus: true, vars: true */</span><span class="s1"> 
</span><span class="s0">/*global google, Highcharts, $*/</span><span class="s1"> 
 
(</span><span class="s2">function </span><span class="s1">() { 
  </span><span class="s3">'use strict'</span><span class="s1">; 
 
  </span><span class="s2">var </span><span class="s1">Chartkick, ISO8601_PATTERN, DECIMAL_SEPARATOR, defaultOptions, hideLegend, 
    setMin, setMax, jsOptions, loaded, waitForLoaded, setBarMin, setBarMax, createDataTable, resize; 
 
  </span><span class="s0">// only functions that need defined specific to charting library</span><span class="s1"> 
  </span><span class="s2">var </span><span class="s1">renderLineChart, renderPieChart, renderColumnChart, renderBarChart, renderAreaChart; 
 
  </span><span class="s0">// helpers</span><span class="s1"> 
 
  </span><span class="s2">function </span><span class="s1">isArray(variable) { 
    </span><span class="s2">return </span><span class="s1">Object.prototype.toString.call(variable) === </span><span class="s3">&quot;[object Array]&quot;</span><span class="s1">; 
  } 
 
  </span><span class="s2">function </span><span class="s1">isFunction(variable) { 
    </span><span class="s2">return </span><span class="s1">variable </span><span class="s2">instanceof </span><span class="s1">Function; 
  } 
 
  </span><span class="s2">function </span><span class="s1">isPlainObject(variable) { 
    </span><span class="s2">return </span><span class="s1">!isFunction(variable) &amp;&amp; variable </span><span class="s2">instanceof </span><span class="s1">Object; 
  } 
 
  </span><span class="s0">// https://github.com/madrobby/zepto/blob/master/src/zepto.js</span><span class="s1"> 
  </span><span class="s2">function </span><span class="s1">extend(target, source) { 
    </span><span class="s2">var </span><span class="s1">key; 
    </span><span class="s2">for </span><span class="s1">(key </span><span class="s2">in </span><span class="s1">source) { 
      </span><span class="s2">if </span><span class="s1">(isPlainObject(source[key]) || isArray(source[key])) { 
        </span><span class="s2">if </span><span class="s1">(isPlainObject(source[key]) &amp;&amp; !isPlainObject(target[key])) { 
          target[key] = {}; 
        } 
        </span><span class="s2">if </span><span class="s1">(isArray(source[key]) &amp;&amp; !isArray(target[key])) { 
          target[key] = []; 
        } 
        extend(target[key], source[key]); 
      } </span><span class="s2">else if </span><span class="s1">(source[key] !== undefined) { 
        target[key] = source[key]; 
      } 
    } 
  } 
 
  </span><span class="s2">function </span><span class="s1">merge(obj1, obj2) { 
    </span><span class="s2">var </span><span class="s1">target = {}; 
    extend(target, obj1); 
    extend(target, obj2); 
    </span><span class="s2">return </span><span class="s1">target; 
  } 
 
  </span><span class="s0">// https://github.com/Do/iso8601.js</span><span class="s1"> 
  ISO8601_PATTERN = </span><span class="s4">/(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)(T)?(\d\d)(:)?(\d\d)?(:)?(\d\d)?([\.,]\d+)?($|Z|([\+\-])(\d\d)(:)?(\d\d)?)/i</span><span class="s1">; 
  DECIMAL_SEPARATOR = String(</span><span class="s4">1.5</span><span class="s1">).charAt(</span><span class="s4">1</span><span class="s1">); 
 
  </span><span class="s2">function </span><span class="s1">parseISO8601(input) { 
    </span><span class="s2">var </span><span class="s1">day, hour, matches, milliseconds, minutes, month, offset, result, seconds, type, year; 
    type = Object.prototype.toString.call(input); 
    </span><span class="s2">if </span><span class="s1">(type === </span><span class="s3">'[object Date]'</span><span class="s1">) { 
      </span><span class="s2">return </span><span class="s1">input; 
    } 
    </span><span class="s2">if </span><span class="s1">(type !== </span><span class="s3">'[object String]'</span><span class="s1">) { 
      </span><span class="s2">return</span><span class="s1">; 
    } 
    </span><span class="s2">if </span><span class="s1">(matches = input.match(ISO8601_PATTERN)) { 
      year = parseInt(matches[</span><span class="s4">1</span><span class="s1">], </span><span class="s4">10</span><span class="s1">); 
      month = parseInt(matches[</span><span class="s4">3</span><span class="s1">], </span><span class="s4">10</span><span class="s1">) - </span><span class="s4">1</span><span class="s1">; 
      day = parseInt(matches[</span><span class="s4">5</span><span class="s1">], </span><span class="s4">10</span><span class="s1">); 
      hour = parseInt(matches[</span><span class="s4">7</span><span class="s1">], </span><span class="s4">10</span><span class="s1">); 
      minutes = matches[</span><span class="s4">9</span><span class="s1">] ? parseInt(matches[</span><span class="s4">9</span><span class="s1">], </span><span class="s4">10</span><span class="s1">) : </span><span class="s4">0</span><span class="s1">; 
      seconds = matches[</span><span class="s4">11</span><span class="s1">] ? parseInt(matches[</span><span class="s4">11</span><span class="s1">], </span><span class="s4">10</span><span class="s1">) : </span><span class="s4">0</span><span class="s1">; 
      milliseconds = matches[</span><span class="s4">12</span><span class="s1">] ? parseFloat(DECIMAL_SEPARATOR + matches[</span><span class="s4">12</span><span class="s1">].slice(</span><span class="s4">1</span><span class="s1">)) * </span><span class="s4">1000 </span><span class="s1">: </span><span class="s4">0</span><span class="s1">; 
      result = Date.UTC(year, month, day, hour, minutes, seconds, milliseconds); 
      </span><span class="s2">if </span><span class="s1">(matches[</span><span class="s4">13</span><span class="s1">] &amp;&amp; matches[</span><span class="s4">14</span><span class="s1">]) { 
        offset = matches[</span><span class="s4">15</span><span class="s1">] * </span><span class="s4">60</span><span class="s1">; 
        </span><span class="s2">if </span><span class="s1">(matches[</span><span class="s4">17</span><span class="s1">]) { 
          offset += parseInt(matches[</span><span class="s4">17</span><span class="s1">], </span><span class="s4">10</span><span class="s1">); 
        } 
        offset *= matches[</span><span class="s4">14</span><span class="s1">] === </span><span class="s3">'-' </span><span class="s1">? -</span><span class="s4">1 </span><span class="s1">: </span><span class="s4">1</span><span class="s1">; 
        result -= offset * </span><span class="s4">60 </span><span class="s1">* </span><span class="s4">1000</span><span class="s1">; 
      } 
      </span><span class="s2">return new </span><span class="s1">Date(result); 
    } 
  } 
  </span><span class="s0">// end iso8601.js</span><span class="s1"> 
 
  </span><span class="s2">function </span><span class="s1">negativeValues(series) { 
    </span><span class="s2">var </span><span class="s1">i, j, data; 
    </span><span class="s2">for </span><span class="s1">(i = </span><span class="s4">0</span><span class="s1">; i &lt; series.length; i++) { 
      data = series[i].data; 
      </span><span class="s2">for </span><span class="s1">(j = </span><span class="s4">0</span><span class="s1">; j &lt; data.length; j++) { 
        </span><span class="s2">if </span><span class="s1">(data[j][</span><span class="s4">1</span><span class="s1">] &lt; </span><span class="s4">0</span><span class="s1">) { 
          </span><span class="s2">return true</span><span class="s1">; 
        } 
      } 
    } 
    </span><span class="s2">return false</span><span class="s1">; 
  } 
 
  </span><span class="s2">function </span><span class="s1">jsOptionsFunc(defaultOptions, hideLegend, setMin, setMax) { 
    </span><span class="s2">return function </span><span class="s1">(series, opts, chartOptions) { 
      </span><span class="s2">var </span><span class="s1">options = merge({}, defaultOptions); 
      options = merge(options, chartOptions || {}); 
 
      </span><span class="s0">// hide legend</span><span class="s1"> 
      </span><span class="s0">// this is *not* an external option!</span><span class="s1"> 
      </span><span class="s2">if </span><span class="s1">(opts.hideLegend) { 
        hideLegend(options); 
      } 
 
      </span><span class="s0">// min</span><span class="s1"> 
      </span><span class="s2">if </span><span class="s1">(</span><span class="s3">&quot;min&quot; </span><span class="s2">in </span><span class="s1">opts) { 
        setMin(options, opts.min); 
      } </span><span class="s2">else if </span><span class="s1">(!negativeValues(series)) { 
        setMin(options, </span><span class="s4">0</span><span class="s1">); 
      } 
 
      </span><span class="s0">// max</span><span class="s1"> 
      </span><span class="s2">if </span><span class="s1">(</span><span class="s3">&quot;max&quot; </span><span class="s2">in </span><span class="s1">opts) { 
        setMax(options, opts.max); 
      } 
 
      </span><span class="s0">// merge library last</span><span class="s1"> 
      options = merge(options, opts.library || {}); 
 
      </span><span class="s2">return </span><span class="s1">options; 
    }; 
  } 
 
  </span><span class="s2">function </span><span class="s1">setText(element, text) { 
    </span><span class="s2">if </span><span class="s1">(document.body.innerText) { 
      element.innerText = text; 
    } </span><span class="s2">else </span><span class="s1">{ 
      element.textContent = text; 
    } 
  } 
 
  </span><span class="s2">function </span><span class="s1">chartError(element, message) { 
    setText(element, </span><span class="s3">&quot;Error Loading Chart: &quot; </span><span class="s1">+ message); 
    element.style.color = </span><span class="s3">&quot;#ff0000&quot;</span><span class="s1">; 
  } 
 
  </span><span class="s2">function </span><span class="s1">getJSON(element, url, success) { 
    $.ajax({ 
      dataType: </span><span class="s3">&quot;json&quot;</span><span class="s1">, 
      url: url, 
      success: success, 
      error: </span><span class="s2">function </span><span class="s1">(jqXHR, textStatus, errorThrown) { 
        </span><span class="s2">var </span><span class="s1">message = (</span><span class="s2">typeof </span><span class="s1">errorThrown === </span><span class="s3">&quot;string&quot;</span><span class="s1">) ? errorThrown : errorThrown.message; 
        chartError(element, message); 
      } 
    }); 
  } 
 
  </span><span class="s2">function </span><span class="s1">errorCatcher(element, data, opts, callback) { 
    </span><span class="s2">try </span><span class="s1">{ 
      callback(element, data, opts); 
    } </span><span class="s2">catch </span><span class="s1">(err) { 
      chartError(element, err.message); 
      </span><span class="s2">throw </span><span class="s1">err; 
    } 
  } 
 
  </span><span class="s2">function </span><span class="s1">fetchDataSource(element, dataSource, opts, callback) { 
    </span><span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">dataSource === </span><span class="s3">&quot;string&quot;</span><span class="s1">) { 
      getJSON(element, dataSource, </span><span class="s2">function </span><span class="s1">(data, textStatus, jqXHR) { 
        errorCatcher(element, data, opts, callback); 
      }); 
    } </span><span class="s2">else </span><span class="s1">{ 
      errorCatcher(element, dataSource, opts, callback); 
    } 
  } 
 
  </span><span class="s0">// type conversions</span><span class="s1"> 
 
  </span><span class="s2">function </span><span class="s1">toStr(n) { 
    </span><span class="s2">return </span><span class="s3">&quot;&quot; </span><span class="s1">+ n; 
  } 
 
  </span><span class="s2">function </span><span class="s1">toFloat(n) { 
    </span><span class="s2">return </span><span class="s1">parseFloat(n); 
  } 
 
  </span><span class="s2">function </span><span class="s1">toDate(n) { 
    </span><span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">n !== </span><span class="s3">&quot;object&quot;</span><span class="s1">) { 
      </span><span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">n === </span><span class="s3">&quot;number&quot;</span><span class="s1">) { 
        n = </span><span class="s2">new </span><span class="s1">Date(n * </span><span class="s4">1000</span><span class="s1">); </span><span class="s0">// ms</span><span class="s1"> 
      } </span><span class="s2">else </span><span class="s1">{ </span><span class="s0">// str</span><span class="s1"> 
        </span><span class="s0">// try our best to get the str into iso8601</span><span class="s1"> 
        </span><span class="s0">// TODO be smarter about this</span><span class="s1"> 
        </span><span class="s2">var </span><span class="s1">str = n.replace(</span><span class="s4">/ /</span><span class="s1">, </span><span class="s3">&quot;T&quot;</span><span class="s1">).replace(</span><span class="s3">&quot; &quot;</span><span class="s1">, </span><span class="s3">&quot;&quot;</span><span class="s1">).replace(</span><span class="s3">&quot;UTC&quot;</span><span class="s1">, </span><span class="s3">&quot;Z&quot;</span><span class="s1">); 
        n = parseISO8601(str) || </span><span class="s2">new </span><span class="s1">Date(n); 
      } 
    } 
    </span><span class="s2">return </span><span class="s1">n; 
  } 
 
  </span><span class="s2">function </span><span class="s1">toArr(n) { 
    </span><span class="s2">if </span><span class="s1">(!isArray(n)) { 
      </span><span class="s2">var </span><span class="s1">arr = [], i; 
      </span><span class="s2">for </span><span class="s1">(i </span><span class="s2">in </span><span class="s1">n) { 
        </span><span class="s2">if </span><span class="s1">(n.hasOwnProperty(i)) { 
          arr.push([i, n[i]]); 
        } 
      } 
      n = arr; 
    } 
    </span><span class="s2">return </span><span class="s1">n; 
  } 
 
  </span><span class="s2">function </span><span class="s1">sortByTime(a, b) { 
    </span><span class="s2">return </span><span class="s1">a[</span><span class="s4">0</span><span class="s1">].getTime() - b[</span><span class="s4">0</span><span class="s1">].getTime(); 
  } 
 
  </span><span class="s2">if </span><span class="s1">(</span><span class="s3">&quot;Highcharts&quot; </span><span class="s2">in </span><span class="s1">window) { 
 
    defaultOptions = { 
      chart: {}, 
      xAxis: { 
        labels: { 
          style: { 
            fontSize: </span><span class="s3">&quot;12px&quot;</span><span class="s1"> 
          } 
        } 
      }, 
      yAxis: { 
        title: { 
          text: </span><span class="s2">null</span><span class="s1"> 
        }, 
        labels: { 
          style: { 
            fontSize: </span><span class="s3">&quot;12px&quot;</span><span class="s1"> 
          } 
        } 
      }, 
      title: { 
        text: </span><span class="s2">null</span><span class="s1"> 
      }, 
      credits: { 
        enabled: </span><span class="s2">false</span><span class="s1"> 
      }, 
      legend: { 
        borderWidth: </span><span class="s4">0</span><span class="s1"> 
      }, 
      tooltip: { 
        style: { 
          fontSize: </span><span class="s3">&quot;12px&quot;</span><span class="s1"> 
        } 
      }, 
      plotOptions: { 
        areaspline: {}, 
        series: { 
          marker: {} 
        } 
      } 
    }; 
 
    hideLegend = </span><span class="s2">function </span><span class="s1">(options) { 
      options.legend.enabled = </span><span class="s2">false</span><span class="s1">; 
    }; 
 
    setMin = </span><span class="s2">function </span><span class="s1">(options, min) { 
      options.yAxis.min = min; 
    }; 
 
    setMax = </span><span class="s2">function </span><span class="s1">(options, max) { 
      options.yAxis.max = max; 
    }; 
 
    jsOptions = jsOptionsFunc(defaultOptions, hideLegend, setMin, setMax); 
 
    renderLineChart = </span><span class="s2">function </span><span class="s1">(element, series, opts, chartType) { 
      chartType = chartType || </span><span class="s3">&quot;spline&quot;</span><span class="s1">; 
      </span><span class="s2">var </span><span class="s1">chartOptions = {}; 
      </span><span class="s2">if </span><span class="s1">(chartType === </span><span class="s3">&quot;areaspline&quot;</span><span class="s1">) { 
        chartOptions = { 
          plotOptions: { 
            areaspline: { 
              stacking: </span><span class="s3">&quot;normal&quot;</span><span class="s1"> 
            }, 
            series: { 
              marker: { 
                enabled: </span><span class="s2">false</span><span class="s1"> 
              } 
            } 
          } 
        }; 
      } 
      </span><span class="s2">var </span><span class="s1">options = jsOptions(series, opts, chartOptions), data, i, j; 
      options.xAxis.type = </span><span class="s3">&quot;datetime&quot;</span><span class="s1">; 
      options.chart.type = chartType; 
      options.chart.renderTo = element.id; 
 
      </span><span class="s2">for </span><span class="s1">(i = </span><span class="s4">0</span><span class="s1">; i &lt; series.length; i++) { 
        data = series[i].data; 
        </span><span class="s2">for </span><span class="s1">(j = </span><span class="s4">0</span><span class="s1">; j &lt; data.length; j++) { 
          data[j][</span><span class="s4">0</span><span class="s1">] = data[j][</span><span class="s4">0</span><span class="s1">].getTime(); 
        } 
        series[i].marker = {symbol: </span><span class="s3">&quot;circle&quot;</span><span class="s1">}; 
      } 
      options.series = series; 
      </span><span class="s2">new </span><span class="s1">Highcharts.Chart(options); 
    }; 
 
    renderPieChart = </span><span class="s2">function </span><span class="s1">(element, series, opts) { 
      </span><span class="s2">var </span><span class="s1">options = merge(defaultOptions, opts.library || {}); 
      options.chart.renderTo = element.id; 
      options.series = [{ 
        type: </span><span class="s3">&quot;pie&quot;</span><span class="s1">, 
        name: </span><span class="s3">&quot;Value&quot;</span><span class="s1">, 
        data: series 
      }]; 
      </span><span class="s2">new </span><span class="s1">Highcharts.Chart(options); 
    }; 
 
    renderColumnChart = </span><span class="s2">function </span><span class="s1">(element, series, opts, chartType) { 
      chartType = chartType || </span><span class="s3">&quot;column&quot;</span><span class="s1">; 
      </span><span class="s2">var </span><span class="s1">options = jsOptions(series, opts), i, j, s, d, rows = []; 
      options.chart.type = chartType; 
      options.chart.renderTo = element.id; 
 
      </span><span class="s2">for </span><span class="s1">(i = </span><span class="s4">0</span><span class="s1">; i &lt; series.length; i++) { 
        s = series[i]; 
 
        </span><span class="s2">for </span><span class="s1">(j = </span><span class="s4">0</span><span class="s1">; j &lt; s.data.length; j++) { 
          d = s.data[j]; 
          </span><span class="s2">if </span><span class="s1">(!rows[d[</span><span class="s4">0</span><span class="s1">]]) { 
            rows[d[</span><span class="s4">0</span><span class="s1">]] = </span><span class="s2">new </span><span class="s1">Array(series.length); 
          } 
          rows[d[</span><span class="s4">0</span><span class="s1">]][i] = d[</span><span class="s4">1</span><span class="s1">]; 
        } 
      } 
 
      </span><span class="s2">var </span><span class="s1">categories = []; 
      </span><span class="s2">for </span><span class="s1">(i </span><span class="s2">in </span><span class="s1">rows) { 
        </span><span class="s2">if </span><span class="s1">(rows.hasOwnProperty(i)) { 
          categories.push(i); 
        } 
      } 
      options.xAxis.categories = categories; 
 
      </span><span class="s2">var </span><span class="s1">newSeries = []; 
      </span><span class="s2">for </span><span class="s1">(i = </span><span class="s4">0</span><span class="s1">; i &lt; series.length; i++) { 
        d = []; 
        </span><span class="s2">for </span><span class="s1">(j = </span><span class="s4">0</span><span class="s1">; j &lt; categories.length; j++) { 
          d.push(rows[categories[j]][i] || </span><span class="s4">0</span><span class="s1">); 
        } 
 
        newSeries.push({ 
          name: series[i].name, 
          data: d 
        }); 
      } 
      options.series = newSeries; 
 
      </span><span class="s2">new </span><span class="s1">Highcharts.Chart(options); 
    }; 
 
    renderBarChart = </span><span class="s2">function </span><span class="s1">(element, series, opts) { 
      renderColumnChart(element, series, opts, </span><span class="s3">&quot;bar&quot;</span><span class="s1">); 
    }; 
 
    renderAreaChart = </span><span class="s2">function </span><span class="s1">(element, series, opts) { 
      renderLineChart(element, series, opts, </span><span class="s3">&quot;areaspline&quot;</span><span class="s1">); 
    }; 
  } </span><span class="s2">else if </span><span class="s1">(</span><span class="s3">&quot;google&quot; </span><span class="s2">in </span><span class="s1">window) { </span><span class="s0">// Google charts</span><span class="s1"> 
    </span><span class="s0">// load from google</span><span class="s1"> 
    loaded = </span><span class="s2">false</span><span class="s1">; 
    google.setOnLoadCallback(</span><span class="s2">function </span><span class="s1">() { 
      loaded = </span><span class="s2">true</span><span class="s1">; 
    }); 
    google.load(</span><span class="s3">&quot;visualization&quot;</span><span class="s1">, </span><span class="s3">&quot;1.0&quot;</span><span class="s1">, {</span><span class="s3">&quot;packages&quot;</span><span class="s1">: [</span><span class="s3">&quot;corechart&quot;</span><span class="s1">]}); 
 
    waitForLoaded = </span><span class="s2">function </span><span class="s1">(callback) { 
      google.setOnLoadCallback(callback); </span><span class="s0">// always do this to prevent race conditions (watch out for other issues due to this)</span><span class="s1"> 
      </span><span class="s2">if </span><span class="s1">(loaded) { 
        callback(); 
      } 
    }; 
 
    </span><span class="s0">// Set chart options</span><span class="s1"> 
    defaultOptions = { 
      chartArea: {}, 
      fontName: </span><span class="s3">&quot;'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif&quot;</span><span class="s1">, 
      pointSize: </span><span class="s4">6</span><span class="s1">, 
      legend: { 
        textStyle: { 
          fontSize: </span><span class="s4">12</span><span class="s1">, 
          color: </span><span class="s3">&quot;#444&quot;</span><span class="s1"> 
        }, 
        alignment: </span><span class="s3">&quot;center&quot;</span><span class="s1">, 
        position: </span><span class="s3">&quot;right&quot;</span><span class="s1"> 
      }, 
      curveType: </span><span class="s3">&quot;function&quot;</span><span class="s1">, 
      hAxis: { 
        textStyle: { 
          color: </span><span class="s3">&quot;#666&quot;</span><span class="s1">, 
          fontSize: </span><span class="s4">12</span><span class="s1"> 
        }, 
        gridlines: { 
          color: </span><span class="s3">&quot;transparent&quot;</span><span class="s1"> 
        }, 
        baselineColor: </span><span class="s3">&quot;#ccc&quot;</span><span class="s1">, 
        viewWindow: {} 
      }, 
      vAxis: { 
        textStyle: { 
          color: </span><span class="s3">&quot;#666&quot;</span><span class="s1">, 
          fontSize: </span><span class="s4">12</span><span class="s1"> 
        }, 
        baselineColor: </span><span class="s3">&quot;#ccc&quot;</span><span class="s1">, 
        viewWindow: {} 
      }, 
      tooltip: { 
        textStyle: { 
          color: </span><span class="s3">&quot;#666&quot;</span><span class="s1">, 
          fontSize: </span><span class="s4">12</span><span class="s1"> 
        } 
      } 
    }; 
 
    hideLegend = </span><span class="s2">function </span><span class="s1">(options) { 
      options.legend.position = </span><span class="s3">&quot;none&quot;</span><span class="s1">; 
    }; 
 
    setMin = </span><span class="s2">function </span><span class="s1">(options, min) { 
      options.vAxis.viewWindow.min = min; 
    }; 
 
    setMax = </span><span class="s2">function </span><span class="s1">(options, max) { 
      options.vAxis.viewWindow.max = max; 
    }; 
 
    setBarMin = </span><span class="s2">function </span><span class="s1">(options, min) { 
      options.hAxis.viewWindow.min = min; 
    }; 
 
    setBarMax = </span><span class="s2">function </span><span class="s1">(options, max) { 
      options.hAxis.viewWindow.max = max; 
    }; 
 
    jsOptions = jsOptionsFunc(defaultOptions, hideLegend, setMin, setMax); 
 
    </span><span class="s0">// cant use object as key</span><span class="s1"> 
    createDataTable = </span><span class="s2">function </span><span class="s1">(series, columnType) { 
      </span><span class="s2">var </span><span class="s1">data = </span><span class="s2">new </span><span class="s1">google.visualization.DataTable(); 
      data.addColumn(columnType, </span><span class="s3">&quot;&quot;</span><span class="s1">); 
 
      </span><span class="s2">var </span><span class="s1">i, j, s, d, key, rows = []; 
      </span><span class="s2">for </span><span class="s1">(i = </span><span class="s4">0</span><span class="s1">; i &lt; series.length; i++) { 
        s = series[i]; 
        data.addColumn(</span><span class="s3">&quot;number&quot;</span><span class="s1">, s.name); 
 
        </span><span class="s2">for </span><span class="s1">(j = </span><span class="s4">0</span><span class="s1">; j &lt; s.data.length; j++) { 
          d = s.data[j]; 
          key = (columnType === </span><span class="s3">&quot;datetime&quot;</span><span class="s1">) ? d[</span><span class="s4">0</span><span class="s1">].getTime() : d[</span><span class="s4">0</span><span class="s1">]; 
          </span><span class="s2">if </span><span class="s1">(!rows[key]) { 
            rows[key] = </span><span class="s2">new </span><span class="s1">Array(series.length); 
          } 
          rows[key][i] = toFloat(d[</span><span class="s4">1</span><span class="s1">]); 
        } 
      } 
 
      </span><span class="s2">var </span><span class="s1">rows2 = []; 
      </span><span class="s2">for </span><span class="s1">(i </span><span class="s2">in </span><span class="s1">rows) { 
        </span><span class="s2">if </span><span class="s1">(rows.hasOwnProperty(i)) { 
          rows2.push([(columnType === </span><span class="s3">&quot;datetime&quot;</span><span class="s1">) ? </span><span class="s2">new </span><span class="s1">Date(toFloat(i)) : i].concat(rows[i])); 
        } 
      } 
      </span><span class="s2">if </span><span class="s1">(columnType === </span><span class="s3">&quot;datetime&quot;</span><span class="s1">) { 
        rows2.sort(sortByTime); 
      } 
      data.addRows(rows2); 
 
      </span><span class="s2">return </span><span class="s1">data; 
    }; 
 
    resize = </span><span class="s2">function </span><span class="s1">(callback) { 
      </span><span class="s2">if </span><span class="s1">(window.attachEvent) { 
        window.attachEvent(</span><span class="s3">&quot;onresize&quot;</span><span class="s1">, callback); 
      } </span><span class="s2">else if </span><span class="s1">(window.addEventListener) { 
        window.addEventListener(</span><span class="s3">&quot;resize&quot;</span><span class="s1">, callback, </span><span class="s2">true</span><span class="s1">); 
      } 
      callback(); 
    }; 
 
    renderLineChart = </span><span class="s2">function </span><span class="s1">(element, series, opts) { 
      waitForLoaded(</span><span class="s2">function </span><span class="s1">() { 
        </span><span class="s2">var </span><span class="s1">options = jsOptions(series, opts); 
        </span><span class="s2">var </span><span class="s1">data = createDataTable(series, </span><span class="s3">&quot;datetime&quot;</span><span class="s1">); 
        </span><span class="s2">var </span><span class="s1">chart = </span><span class="s2">new </span><span class="s1">google.visualization.LineChart(element); 
        resize(</span><span class="s2">function </span><span class="s1">() { 
          chart.draw(data, options); 
        }); 
      }); 
    }; 
 
    renderPieChart = </span><span class="s2">function </span><span class="s1">(element, series, opts) { 
      waitForLoaded(</span><span class="s2">function </span><span class="s1">() { 
        </span><span class="s2">var </span><span class="s1">chartOptions = { 
          chartArea: { 
            top: </span><span class="s3">&quot;10%&quot;</span><span class="s1">, 
            height: </span><span class="s3">&quot;80%&quot;</span><span class="s1"> 
          } 
        }; 
        </span><span class="s2">var </span><span class="s1">options = merge(merge(defaultOptions, chartOptions), opts.library || {}); 
 
        </span><span class="s2">var </span><span class="s1">data = </span><span class="s2">new </span><span class="s1">google.visualization.DataTable(); 
        data.addColumn(</span><span class="s3">&quot;string&quot;</span><span class="s1">, </span><span class="s3">&quot;&quot;</span><span class="s1">); 
        data.addColumn(</span><span class="s3">&quot;number&quot;</span><span class="s1">, </span><span class="s3">&quot;Value&quot;</span><span class="s1">); 
        data.addRows(series); 
 
        </span><span class="s2">var </span><span class="s1">chart = </span><span class="s2">new </span><span class="s1">google.visualization.PieChart(element); 
        resize(</span><span class="s2">function </span><span class="s1">() { 
          chart.draw(data, options); 
        }); 
      }); 
    }; 
 
    renderColumnChart = </span><span class="s2">function </span><span class="s1">(element, series, opts) { 
      waitForLoaded(</span><span class="s2">function </span><span class="s1">() { 
        </span><span class="s2">var </span><span class="s1">options = jsOptions(series, opts); 
        </span><span class="s2">var </span><span class="s1">data = createDataTable(series, </span><span class="s3">&quot;string&quot;</span><span class="s1">); 
        </span><span class="s2">var </span><span class="s1">chart = </span><span class="s2">new </span><span class="s1">google.visualization.ColumnChart(element); 
        resize(</span><span class="s2">function </span><span class="s1">() { 
          chart.draw(data, options); 
        }); 
      }); 
    }; 
 
    renderBarChart = </span><span class="s2">function </span><span class="s1">(element, series, opts) { 
      waitForLoaded(</span><span class="s2">function </span><span class="s1">() { 
        </span><span class="s2">var </span><span class="s1">chartOptions = { 
          hAxis: { 
            gridlines: { 
              color: </span><span class="s3">&quot;#ccc&quot;</span><span class="s1"> 
            } 
          } 
        }; 
        </span><span class="s2">var </span><span class="s1">options = jsOptionsFunc(defaultOptions, hideLegend, setBarMin, setBarMax)(series, opts, chartOptions); 
        </span><span class="s2">var </span><span class="s1">data = createDataTable(series, </span><span class="s3">&quot;string&quot;</span><span class="s1">); 
        </span><span class="s2">var </span><span class="s1">chart = </span><span class="s2">new </span><span class="s1">google.visualization.BarChart(element); 
        resize(</span><span class="s2">function </span><span class="s1">() { 
          chart.draw(data, options); 
        }); 
      }); 
    }; 
 
    renderAreaChart = </span><span class="s2">function </span><span class="s1">(element, series, opts) { 
      waitForLoaded(</span><span class="s2">function </span><span class="s1">() { 
        </span><span class="s2">var </span><span class="s1">chartOptions = { 
          isStacked: </span><span class="s2">true</span><span class="s1">, 
          pointSize: </span><span class="s4">0</span><span class="s1">, 
          areaOpacity: </span><span class="s4">0.5</span><span class="s1"> 
        }; 
        </span><span class="s2">var </span><span class="s1">options = jsOptions(series, opts, chartOptions); 
        </span><span class="s2">var </span><span class="s1">data = createDataTable(series, </span><span class="s3">&quot;datetime&quot;</span><span class="s1">); 
        </span><span class="s2">var </span><span class="s1">chart = </span><span class="s2">new </span><span class="s1">google.visualization.AreaChart(element); 
        resize(</span><span class="s2">function </span><span class="s1">() { 
          chart.draw(data, options); 
        }); 
      }); 
    }; 
  } </span><span class="s2">else </span><span class="s1">{ </span><span class="s0">// no chart library installed</span><span class="s1"> 
    renderLineChart = renderPieChart = renderColumnChart = renderBarChart = renderAreaChart = </span><span class="s2">function </span><span class="s1">() { 
      </span><span class="s2">throw new </span><span class="s1">Error(</span><span class="s3">&quot;Please install Google Charts or Highcharts&quot;</span><span class="s1">); 
    }; 
  } 
 
  </span><span class="s0">// process data</span><span class="s1"> 
 
  </span><span class="s2">function </span><span class="s1">processSeries(series, opts, time) { 
    </span><span class="s2">var </span><span class="s1">i, j, data, r, key; 
 
    </span><span class="s0">// see if one series or multiple</span><span class="s1"> 
    </span><span class="s2">if </span><span class="s1">(!isArray(series) || </span><span class="s2">typeof </span><span class="s1">series[</span><span class="s4">0</span><span class="s1">] !== </span><span class="s3">&quot;object&quot; </span><span class="s1">|| isArray(series[</span><span class="s4">0</span><span class="s1">])) { 
      series = [{name: </span><span class="s3">&quot;Value&quot;</span><span class="s1">, data: series}]; 
      opts.hideLegend = </span><span class="s2">true</span><span class="s1">; 
    } </span><span class="s2">else </span><span class="s1">{ 
      opts.hideLegend = </span><span class="s2">false</span><span class="s1">; 
    } 
 
    </span><span class="s0">// right format</span><span class="s1"> 
    </span><span class="s2">for </span><span class="s1">(i = </span><span class="s4">0</span><span class="s1">; i &lt; series.length; i++) { 
      data = toArr(series[i].data); 
      r = []; 
      </span><span class="s2">for </span><span class="s1">(j = </span><span class="s4">0</span><span class="s1">; j &lt; data.length; j++) { 
        key = data[j][</span><span class="s4">0</span><span class="s1">]; 
        key = time ? toDate(key) : toStr(key); 
        r.push([key, toFloat(data[j][</span><span class="s4">1</span><span class="s1">])]); 
      } 
      </span><span class="s2">if </span><span class="s1">(time) { 
        r.sort(sortByTime); 
      } 
      series[i].data = r; 
    } 
 
    </span><span class="s2">return </span><span class="s1">series; 
  } 
 
  </span><span class="s2">function </span><span class="s1">processLineData(element, data, opts) { 
    renderLineChart(element, processSeries(data, opts, </span><span class="s2">true</span><span class="s1">), opts); 
  } 
 
  </span><span class="s2">function </span><span class="s1">processColumnData(element, data, opts) { 
    renderColumnChart(element, processSeries(data, opts, </span><span class="s2">false</span><span class="s1">), opts); 
  } 
 
  </span><span class="s2">function </span><span class="s1">processPieData(element, data, opts) { 
    </span><span class="s2">var </span><span class="s1">perfectData = toArr(data), i; 
    </span><span class="s2">for </span><span class="s1">(i = </span><span class="s4">0</span><span class="s1">; i &lt; perfectData.length; i++) { 
      perfectData[i] = [toStr(perfectData[i][</span><span class="s4">0</span><span class="s1">]), toFloat(perfectData[i][</span><span class="s4">1</span><span class="s1">])]; 
    } 
    renderPieChart(element, perfectData, opts); 
  } 
 
  </span><span class="s2">function </span><span class="s1">processBarData(element, data, opts) { 
    renderBarChart(element, processSeries(data, opts, </span><span class="s2">false</span><span class="s1">), opts); 
  } 
 
  </span><span class="s2">function </span><span class="s1">processAreaData(element, data, opts) { 
    renderAreaChart(element, processSeries(data, opts, </span><span class="s2">true</span><span class="s1">), opts); 
  } 
 
  </span><span class="s2">function </span><span class="s1">setElement(element, data, opts, callback) { 
    </span><span class="s2">if </span><span class="s1">(</span><span class="s2">typeof </span><span class="s1">element === </span><span class="s3">&quot;string&quot;</span><span class="s1">) { 
      element = document.getElementById(element); 
    } 
    fetchDataSource(element, data, opts || {}, callback); 
  } 
 
  </span><span class="s0">// define classes</span><span class="s1"> 
 
  Chartkick = { 
    LineChart: </span><span class="s2">function </span><span class="s1">(element, dataSource, opts) { 
      setElement(element, dataSource, opts, processLineData); 
    }, 
    PieChart: </span><span class="s2">function </span><span class="s1">(element, dataSource, opts) { 
      setElement(element, dataSource, opts, processPieData); 
    }, 
    ColumnChart: </span><span class="s2">function </span><span class="s1">(element, dataSource, opts) { 
      setElement(element, dataSource, opts, processColumnData); 
    }, 
    BarChart: </span><span class="s2">function </span><span class="s1">(element, dataSource, opts) { 
      setElement(element, dataSource, opts, processBarData); 
    }, 
    AreaChart: </span><span class="s2">function </span><span class="s1">(element, dataSource, opts) { 
      setElement(element, dataSource, opts, processAreaData); 
    } 
  }; 
 
  window.Chartkick = Chartkick; 
}());</span></pre>
</body>
</html>