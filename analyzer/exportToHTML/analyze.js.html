<html>
<head>
<title>analyze.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: rgb(0,0,0); font-weight: normal; font-style: normal; }
.s0 { color: rgb(0,0,128); font-weight: bold; }
.s1 { color: rgb(0,0,0); }
.s2 { color: rgb(0,128,0); font-weight: bold; }
.s3 { color: rgb(128,128,128); font-style: italic; }
.s4 { color: rgb(0,0,255); }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#C0C0C0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
analyze.js</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">var </span><span class="s1">content = [ 
    { title: </span><span class="s2">'http' </span><span class="s1">}, 
    { title: </span><span class="s2">'dns' </span><span class="s1">}, 
    { title: </span><span class="s2">'icmp' </span><span class="s1">}, 
    { title: </span><span class="s2">'smb || nbns || dcerpc || nbss || dns' </span><span class="s1">}, 
    { title: </span><span class="s2">'ip.src==' </span><span class="s1">}, 
    { title: </span><span class="s2">'ip.dst==' </span><span class="s1">}, 
    { title: </span><span class="s2">'ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16' </span><span class="s1">}, 
    { title: </span><span class="s2">'!(ip.src == 10.43.54.65 or ip.dst == 10.43.54.65)'</span><span class="s1">}, 
    { title: </span><span class="s2">'udp contains 81:60:03' </span><span class="s1">}, 
    { title: </span><span class="s2">'eth.addr[0:3]==00:06:5B' </span><span class="s1">}, 
    { title: </span><span class="s2">'http.request.uri matches &quot;login$&quot;' </span><span class="s1">}, 
    { title: </span><span class="s2">'tcp.port eq 25' </span><span class="s1">}, 
    </span><span class="s3">// etc</span><span class="s1"> 
]; 
 
$(document).ready(</span><span class="s0">function</span><span class="s1">() { 
    $(</span><span class="s2">'#analyzer-nav'</span><span class="s1">).addClass(</span><span class="s2">'active'</span><span class="s1">); 
 
    $(</span><span class="s2">'.ui.checkbox'</span><span class="s1">).checkbox(); 
 
    $(</span><span class="s2">'.ui.accordion'</span><span class="s1">).accordion(); 
 
    $(</span><span class="s2">'.menu .item'</span><span class="s1">).tab(); 
 
    $(</span><span class="s2">&quot;#pcaptable&quot;</span><span class="s1">).FixedHead({ tableLayout: </span><span class="s2">&quot;floated&quot; </span><span class="s1">}); 
 
    $(</span><span class="s2">&quot;#example&quot;</span><span class="s1">).FixedHead({ tableLayout: </span><span class="s2">&quot;floated&quot; </span><span class="s1">}); 
 
    $(</span><span class="s2">'.ui.search'</span><span class="s1">).search({ 
        source: content 
    }); 
     
    $(</span><span class="s2">'input#filter'</span><span class="s1">).keyup(</span><span class="s0">function</span><span class="s1">(e){ 
            event.preventDefault(); 
            </span><span class="s0">if </span><span class="s1">(e.keyCode == </span><span class="s4">13</span><span class="s1">) { 
                $(</span><span class="s2">'.ui.small.que.modal'</span><span class="s1">) 
                        .modal({ 
                            closable  : </span><span class="s0">true</span><span class="s1">, 
                            onDeny    : </span><span class="s0">function</span><span class="s1">(){ 
                              </span><span class="s0">return true</span><span class="s1">; 
                            }, 
                            onApprove : </span><span class="s0">function</span><span class="s1">() { 
                              window.location.href= window.location.pathname + </span><span class="s2">'?filter=' </span><span class="s1">+ $(</span><span class="s2">'input#filter'</span><span class="s1">).val(); 
                            } 
                          }).modal(</span><span class="s2">'show'</span><span class="s1">);              
            } 
     }); 
     
    $(</span><span class="s2">'#xxx_tbody'</span><span class="s1">).on(</span><span class="s2">'click'</span><span class="s1">,</span><span class="s2">'.yytr'</span><span class="s1">, </span><span class="s0">function</span><span class="s1">(e){ 
            $(</span><span class="s2">&quot;#loadbartable&quot;</span><span class="s1">).addClass(</span><span class="s2">'active'</span><span class="s1">); 
            $(</span><span class="s2">&quot;#loadbar&quot;</span><span class="s1">).modal({closable  : </span><span class="s0">true</span><span class="s1">,}).modal(</span><span class="s2">'show'</span><span class="s1">); 
            e.preventDefault(); 
            </span><span class="s0">var </span><span class="s1">packetPane = $(</span><span class="s2">'.packetPane'</span><span class="s1">) 
            packetPane.html(</span><span class="s2">''</span><span class="s1">); 
            $(</span><span class="s2">'.spinner'</span><span class="s1">).removeClass(</span><span class="s2">'hide'</span><span class="s1">); 
            </span><span class="s0">var </span><span class="s1">page = window.location.href.split(</span><span class="s2">'/'</span><span class="s1">); 
            page = page[page.length - </span><span class="s4">2</span><span class="s1">] - </span><span class="s4">1</span><span class="s1">; 
            </span><span class="s0">var </span><span class="s1">packetDetail = $.ajax({ 
                type : </span><span class="s2">&quot;GET&quot;</span><span class="s1">, 
                url : </span><span class="s2">&quot;/packetdetail/&quot; </span><span class="s1">+ $(</span><span class="s2">&quot;input[name='analyzeid']&quot;</span><span class="s1">).val() + </span><span class="s2">'/'</span><span class="s1">+ page + </span><span class="s2">'/'</span><span class="s1">+ $(</span><span class="s0">this</span><span class="s1">).children().first().text(), 
                contentType: </span><span class="s2">'application/text;charset=UTF-8'</span><span class="s1">, 
                success: </span><span class="s0">function</span><span class="s1">(text){ 
                    $(</span><span class="s2">'.spinner'</span><span class="s1">).addClass(</span><span class="s2">'hide'</span><span class="s1">); 
                    packetPane.html(text); 
                        $(</span><span class="s2">'.ui.packetPane.modal'</span><span class="s1">) 
                        .modal({ 
                            closable  : </span><span class="s0">true</span><span class="s1">, 
                          }).modal(</span><span class="s2">'show'</span><span class="s1">); 
                } 
            }); 
        }); 
 
    $(</span><span class="s2">'.controller tr'</span><span class="s1">).on(</span><span class="s2">'click'</span><span class="s1">, </span><span class="s0">function</span><span class="s1">(e){ 
            </span><span class="s0">var </span><span class="s1">packetDetail = $.ajax({ 
                type : </span><span class="s2">&quot;GET&quot;</span><span class="s1">, 
                url : </span><span class="s2">&quot;/control/&quot; </span><span class="s1">+ $(</span><span class="s0">this</span><span class="s1">).children().first().attr(</span><span class="s2">'value'</span><span class="s1">) + </span><span class="s2">&quot;/&quot;</span><span class="s1">, 
                contentType: </span><span class="s2">'application/text;charset=UTF-8'</span><span class="s1">, 
                success: </span><span class="s0">function</span><span class="s1">(d){ 
                    </span><span class="s0">var </span><span class="s1">index = layer.load(</span><span class="s4">1</span><span class="s1">, { 
                        shade: [</span><span class="s4">0.1</span><span class="s1">,</span><span class="s2">'#fff'</span><span class="s1">] </span><span class="s3">//0.1透明度的白色背景</span><span class="s1"> 
                    }); 
                    window.location.reload(); 
                } 
            }); 
 
        }); 
 
}); 
</span></pre>
</body>
</html>